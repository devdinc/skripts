test "scoped variable - set & get":
    set scoped {-test} to 12
    assert scoped {-test} is 12

test "scoped variable - add":
    set scoped {-addtest} to 5
    add 3 to scoped {-addtest}
    assert scoped {-addtest} is 8

test "scoped variable - lists":
    set scoped {-lists::*} to "a", "b", "c"
    assert scoped {-lists::*} contains "a"
    assert scoped {-lists::*} contains "b"
    assert scoped {-lists::*} contains "c"

test "scoped variable - remove":
    set scoped {-removetest::*} to "a", "b", "c"
    remove "b" from scoped {-removetest::*}
    assert scoped {-removetest::*} contains "a"
    assert scoped {-removetest::*} contains "c"
    assert scoped {-removetest::*} does not contain "b"

test "scoped variable - remove all":
    set scoped {-removeall::*} to "a", "b", "b", "c"
    remove all "b" from scoped {-removeall::*}
    assert scoped {-removeall::*} is "a", "c"

test "scoped variable - delete":
    set scoped {-deletetest} to 42
    delete scoped {-deletetest}
    assert scoped {-deletetest} is not set

test "scoped variable - reset single value":
    set scoped {-resettest} to 9
    reset scoped {-resettest}
    assert scoped {-resettest} is not set

test "scoped variable - reset list":
    set scoped {-resetlist::*} to 1, 2, 3
    reset scoped {-resetlist::*}
    assert scoped {-resetlist::*} is not set

test "scoped variable - non-ephemeral (named)":
    set scoped {namedtest} to "hello"
    assert scoped {namedtest} is "hello"
    delete scoped {namedtest}

test "scoped variable - script scoping":
    set scoped {-scoped} within current script to 100
    assert scoped {-scoped} is 100
    set scoped {-scoped2} to 100
    assert scoped {-scoped2} within current script is 100

test "scoped variable - inner expression resolution":
    set {_i} to 1
    set scoped {-list::*} to 20
    assert scoped {-list::%{_i}%} is 20
    set {_list::*} to scoped {-list::*}
    assert {_list::%{_i}%} is 20
    assert scoped {-list::1} is 20
    
test "scoped variable - folder vs current script isolation":
    set scoped {-x} within current script to 1
    set scoped {-x} within current folder to 2

    assert scoped {-x} within current script is 1
    assert scoped {-x} within current folder is 2

devdinc test "scoped variable - default scope switch to folder":
    set default scope for scoped variables in current script to current folder

    set scoped {-d} to 42

    without halting assert scoped {-d} within current folder is 42
    without halting assert scoped {-d} within current script is not set
    set default scope for scoped variables in current script to current script

test "scoped variable - default scope is script-local":
    set scoped {-a} to 5

    set default scope for scoped variables in current script to current folder
    set scoped {-b} to 6

    assert scoped {-a} within current script is 5
    assert scoped {-b} within current folder is 6
    set default scope for scoped variables in current script to current script

#test "scoped variable - list folder isolation":
#    set scoped {-l::*} within folder "one" to "a", "b"
#    set scoped {-l::*} within folder "two" to "c"
#
#    assert scoped {-l::*} within folder "one" is "a", "b"
#    assert scoped {-l::*} within folder "two" is "c"

test "scoped variable - reset does not affect other scopes":
    set scoped {-r} within current folder to 1
    set scoped {-r} within current script to 2

    reset scoped {-r} within current script

    assert scoped {-r} within current script is not set
    assert scoped {-r} within current folder is 1

test "scoped variable - locals a":
    set scoped {_locals::a} to 15
    assert scoped {_locals::a} is 15
    
test "scoped variable - locals b":
    assert scoped {_locals::a} is not 15
